<!-- TSEG - Programa de seguimiento de equipos LIECOM -->
<!DOCTYPE html>

<html>
	<head>
		<meta content="initial-scale=1, width=device-width" name="viewport">
		<meta charset="utf-8">
		<link rel="icon" href="{{ url_for('static', filename='images/tecseg_icon.png') }}">
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">		
		
    <!-- CSS usa el metodo de flask para ubicar el archivo-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">    	

		<!-- JS -->
		<script src="{{ url_for('static', filename='scripts.js') }}"></script>
		
		<!-- título por defecto, o toma uno 'title' -->
		{% if title %}
			<title>TECSEG - {{ title }}</title>
		{% else %}
			<title>TECSEG - LOGIN</title>
		{% endif %}
		
	</head>
	<body >	
		<header class="site-header">
			<nav>			
				<ul class="menu-horizontal">
					<a class="navbar-brand" href="/home"><img src="./static/images/LOGO.png" width="75" height="75"></a>
					{% if current_user.is_authenticated %}
						{% if current_user.role.role_name == "Admin" %}
							<li>
								<a class="nav-item nav-link" title="Ver cuentas de usuario"  href="{{ url_for('users.all_users') }}">Admin</a>
								<ul class="menu-vertical">
									<li><a class="nav-item nav-link" href="{{ url_for('users.register') }}" class="list-group-item list-group-item-light">Agregar nuevo usuario</a></li>
								</ul>
							</li>
						{% endif %}
						{% if current_user.role.role_name != "Invitado" %}
							<li>
								<a class="nav-item nav-link" title="Vista de Clientes"  href="{{ url_for('clients.all_clients') }}">Clientes</a>
								<ul class="menu-vertical">
									<li><a class="nav-item nav-link" href="{{ url_for('clients.add_client') }}" class="list-group-item list-group-item-light">Agregar nuevo cliente</a></li>
								</ul>
							</li>
						
							<li>
								<a class="nav-item nav-link" title="Vista de Equipos" href="{{ url_for('equipments.all_equipments') }}">Equipos</a>
								<ul class="menu-vertical">
									<li><a class="nav-item nav-link" href="{{ url_for('equipments.add_equipment', client_id=0) }}" class="list-group-item list-group-item-light">Agregar nuevo equipo</a></li>
								</ul>
							</li>						
						
							<li>
								<a class="nav-item nav-link" title="Órdenes de reparación" href="{{ url_for('ordenes_reparacion.all_ordenes_reparacion') }}" >O.R.</a>
								<ul class="menu-vertical">
									<li><a class="nav-item nav-link" href="{{ url_for('ordenes_reparacion.add_orden_reparacion', equipment_id=0) }}" class="list-group-item list-group-item-light">Agregar nueva OR</a></li>
								</ul>
							</li>
						{% endif %}
							<li>
								<a title="Ir a mi cuenta"  href="{{ url_for('users.account', user_id=current_user.id) }}"><img class="rounded-circle article-img" src="{{ url_for('static', filename='profile_pics/' + 	current_user.image_file) }}"></a>
								<ul class="menu-vertical">
									<li><a class="nav-item nav-link" href="{{ url_for('users.logout') }}">Cerrar sesión</a></li>
								</ul>
							</li>	
					{% else %}
						<li><a class="nav-item nav-link" href="{{ url_for('users.login') }}">Iniciar sesión</a></li>
		      {% endif %}	        
		      
	        <li class="text-right">
	        	<img src="{{ url_for('static', filename='images/theme_dark.png') }}" id="icon" title="Cambiar tema">
	        </li>	        
				</ul>
			</nav>
	    </header>

	    <main role="main" class="container">
	      	<div class="row">
	        	<div class="col-md-8">
		          	{% with messages = get_flashed_messages(with_categories=true) %}
			            {% if messages %}
			            	{% for category, message in messages %}
			                <div class="alert alert-{{ category }}">
			                	{{ message }}
			                </div>
			              	{% endfor %}
			            {% endif %}
		          	{% endwith %}


		          	{% block content %}		          	
		          	{% endblock %}
	        	</div>
		        <div class="col-md-4">
		        	<div class="sticky-top">	          		
        			{% if current_user.is_authenticated %}
        				<article class="media content-section">		          																	    
          				<form class="d-flex ms-auto" role="" method="POST" action="{{ url_for('users.search') }}">
										{{ form.hidden_tag() }}
										<div class="input-group mb-3">
											<input class="form-control" type="search" aria-label="Search" placeholder="Buscar..." name="searched">
											<div class="input-group-append">
												<button class="btn btn-secondary" type="submit"><i class="bi bi-search"></i></button>
											</div>
										</div>
									</form>
      					</article>
          		{% endif %}		          		
		         	</div>
	        	</div>
	      	</div>
	    </main>
	    <br>
		<footer id="footer" class="footer">
			<!-- Optional JavaScript -->
	    	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
		    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>			
		    <div class="copyright">		    	
		    	&copy; TECSEG 2023 <strong>Agustín Arnaiz</strong>		    	
		    </div>		    
		</footer>
	</body>

  <script type="text/javascript">
    window.addEventListener("DOMContentLoaded", function() {
      var icon = document.getElementById("icon");
      var body = document.body;

      // Recuperar el estado del tema del almacenamiento local
      var theme = localStorage.getItem("theme");
      if (theme === "light") {
        body.classList.add("theme-light");
      }

      icon.onclick = function() {
        body.classList.toggle("theme-light");
        document.body.style.transition = '2s';
        if(document.body.classList.contains("theme-light")){
        	icon.src = "{{ url_for('static', filename='images/theme_light.png') }}";
        	icon.title = "Cambiar a modo oscuro";
        }else{
        	icon.src = "{{ url_for('static', filename='images/theme_dark.png') }}";
        	icon.title = "Cambiar a modo claro";
        }

        // Guardar el estado del tema en el almacenamiento local
        if (body.classList.contains("theme-light")) {
          localStorage.setItem("theme", "light");
        } else {
          localStorage.setItem("theme", "dark");
        }
      };
    });
    function cambiarColor() {
		  var selectElement = document.getElementById("estadoSelect");
		  var selectedOption = selectElement.options[selectElement.selectedIndex];
		  selectElement.className = selectedOption.className + " selected";
		}
  </script>
</html>

	</body>
</html>